<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Password Strength Comparator</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #f4f6f8;
        margin: 0; padding: 20px;
    }
    .container {
        max-width: 700px;
        margin: auto;
        background: #fff;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 0 10px #0002;
    }
    input {
        width: 100%;
        padding: 10px;
        margin-top: 5px;
        margin-bottom: 20px;
        font-size: 16px;
        border-radius: 5px;
        border: 1px solid #ccc;
    }
    button {
        padding: 10px 20px;
        font-size: 16px;
        border: none;
        border-radius: 5px;
        background: #007bff;
        color: white;
        cursor: pointer;
    }
    button:hover { background: #0056b3; }
    .result-box {
        background: #eef3ff;
        padding: 15px;
        border-radius: 6px;
        white-space: pre-wrap;
        margin-top: 20px;
    }
    .stronger {
        font-weight: bold;
        font-size: 18px;
        color: #008000;
        margin-top: 10px;
    }
    .indicator {
        margin-top: 10px;
        font-size: 14px;
    }
    .bar-container {
        display: flex;
        height: 20px;
        margin-top: 5px;
        border-radius: 5px;
        overflow: hidden;
        background: #ddd;
    }
    .bar {
        height: 100%;
    }
    .uppercase { background: #007bff; }
    .lowercase { background: #28a745; }
    .numbers { background: #ffc107; }
    .symbols { background: #dc3545; }
    .strength-meter {
        height: 15px;
        border-radius: 5px;
        margin-top: 5px;
        background: #ddd;
        overflow: hidden;
    }
    .strength-bar {
        height: 100%;
        text-align: center;
        color: white;
        font-size: 12px;
        line-height: 15px;
        font-weight: bold;
    }
    .explanation {
        margin-top: 10px;
        font-size: 14px;
        background: #fff5e6;
        padding: 10px;
        border-radius: 5px;
    }
</style>
</head>
<body>

<div class="container">
    <h2>Password Strength Comparator</h2>

    <label>Enter Password 1:</label>
    <input id="pw1" type="text">

    <label>Enter Password 2:</label>
    <input id="pw2" type="text">

    <button onclick="comparePasswords()">Compare Passwords</button>

    <div id="output" class="result-box"></div>
</div>

<script>
// Count character types
function countCharTypes(password) {
    return {
        uppercase: (password.match(/[A-Z]/g) || []).length,
        lowercase: (password.match(/[a-z]/g) || []).length,
        numbers: (password.match(/[0-9]/g) || []).length,
        symbols: (password.match(/[^A-Za-z0-9]/g) || []).length,
        length: password.length
    };
}

// Estimate charset size
function estimateCharsetSize(password) {
    let charset = 0;
    if (/[a-z]/.test(password)) charset += 26;
    if (/[A-Z]/.test(password)) charset += 26;
    if (/[0-9]/.test(password)) charset += 10;
    if (/[^A-Za-z0-9]/.test(password)) charset += 32; // approximate symbol set
    return charset;
}

// Theoretical entropy
function theoreticalEntropy(len, charsetSize) {
    return len * Math.log2(charsetSize);
}

// Effective entropy calculation
function effectiveEntropy(password) {
    const charsetSize = estimateCharsetSize(password);
    const len = password.length;
    let entropy = theoreticalEntropy(len, charsetSize);
    let penalty = 0;

    const repeats = password.length - new Set(password).size;
    penalty += repeats * 1.0;

    let run = 1;
    for (let i = 1; i < password.length; i++) {
        const sameCategory =
            (/[a-z]/.test(password[i]) && /[a-z]/.test(password[i-1])) ||
            (/[A-Z]/.test(password[i]) && /[A-Z]/.test(password[i-1])) ||
            (/[0-9]/.test(password[i]) && /[0-9]/.test(password[i-1])) ||
            (/[^A-Za-z0-9]/.test(password[i]) && /[^A-Za-z0-9]/.test(password[i-1]));
        if (sameCategory) run++;
        else {
            if (run === 2) penalty += 0.5;
            if (run >= 3) penalty += 2 + (run - 3) * 0.5;
            run = 1;
        }
    }
    if (run === 2) penalty += 0.5;
    if (run >= 3) penalty += 2 + (run - 3) * 0.5;

    const symbols = password.match(/[^A-Za-z0-9]/g)?.length || 0;
    if (symbols === 0) penalty += 5;
    else if (symbols === 1) penalty += 2;

    return entropy - penalty;
}

// Generate colored composition bar
function generateBar(counts) {
    const total = counts.uppercase + counts.lowercase + counts.numbers + counts.symbols;
    if (total === 0) return '';

    const uc = (counts.uppercase/total*100).toFixed(1);
    const lc = (counts.lowercase/total*100).toFixed(1);
    const num = (counts.numbers/total*100).toFixed(1);
    const sym = (counts.symbols/total*100).toFixed(1);

    return `
    <div class="bar-container">
        <div class="bar uppercase" style="width:${uc}%;"></div>
        <div class="bar lowercase" style="width:${lc}%;"></div>
        <div class="bar numbers" style="width:${num}%;"></div>
        <div class="bar symbols" style="width:${sym}%;"></div>
    </div>
    <div class="indicator">
        Uppercase: ${counts.uppercase}, Lowercase: ${counts.lowercase}, Numbers: ${counts.numbers}, Symbols: ${counts.symbols}, Length: ${counts.length}
    </div>
    `;
}

// Generate strength meter
function generateStrengthMeter(entropy) {
    let label = "", color = "", pct = Math.min(entropy, 128)/128*100;
    if (entropy < 28) { label="Very Weak"; color="#dc3545"; }
    else if (entropy < 36) { label="Weak"; color="#ff6f00"; }
    else if (entropy < 60) { label="Moderate"; color="#ffc107"; }
    else if (entropy < 128) { label="Strong"; color="#28a745"; }
    else { label="Very Strong"; color="#007bff"; }

    return `
    <div class="strength-meter">
        <div class="strength-bar" style="width:${pct}%;background:${color}">${label}</div>
    </div>
    `;
}

// Compare two passwords
function comparePasswords() {
    const pw1 = document.getElementById("pw1").value;
    const pw2 = document.getElementById("pw2").value;
    const output = document.getElementById("output");

    if (!pw1 || !pw2) {
        output.textContent = "Please enter both passwords.";
        return;
    }

    const e1 = effectiveEntropy(pw1);
    const e2 = effectiveEntropy(pw2);

    const counts1 = countCharTypes(pw1);
    const counts2 = countCharTypes(pw2);

    let stronger, explanation;
    if (e1 > e2) {
        stronger = "Password 1 is stronger.";
        explanation = `Password 1 has higher effective entropy by ${(e1-e2).toFixed(2)} bits.\nBetter mix of character types and/or longer length.`;
    } else {
        stronger = "Password 2 is stronger.";
        explanation = `Password 2 has higher effective entropy by ${(e2-e1).toFixed(2)} bits.\nBetter mix of character types and/or longer length.`;
    }

    output.innerHTML =
        `<b>Password 1 Effective Entropy:</b> ${e1.toFixed(2)} bits` +
        generateBar(counts1) +
        generateStrengthMeter(e1) +
        `<b>Password 2 Effective Entropy:</b> ${e2.toFixed(2)} bits` +
        generateBar(counts2) +
        generateStrengthMeter(e2) +
        `<div class='stronger'>${stronger}</div>` +
        `<div class='explanation'><b>Why:</b> ${explanation}</div>`;
}
</script>

</body>
</html>
